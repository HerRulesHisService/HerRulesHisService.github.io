<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kink Exploration Game</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-bg: #1a1a2e;
            --secondary-bg: #16213e;
            --card-bg: #0f3460;
            --accent: #e94560;
            --text: #f1f1f1;
            --tick: #4CAF50;
            --cross: #f44336;
            --question: #FFC107;
            --male: #2196F3;
            --female: #E91E63;
            --nonbinary: #9C27B0;
            --border-radius: 10px;
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --beginner: #4CAF50;
            --intermediate: #FF9800;
            --advanced: #F44336;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-main);
            background-color: var(--primary-bg);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: var(--secondary-bg);
            border-radius: var(--border-radius);
            border-left: 5px solid var(--accent);
        }
        
        h1 {
            color: var(--accent);
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.8;
            margin-bottom: 20px;
        }
        
        .profile-form {
            background-color: var(--secondary-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            max-width: 800px;
            margin: 0 auto 30px;
        }
        
        .form-section {
            margin-bottom: 30px;
        }
        
        .form-title {
            color: var(--accent);
            margin-bottom: 15px;
            font-size: 1.5rem;
            border-bottom: 2px solid var(--accent);
            padding-bottom: 5px;
            display: inline-block;
        }
        
        .options-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }
        
        .option-btn {
            padding: 12px 25px;
            background-color: var(--card-bg);
            color: var(--text);
            border: 2px solid transparent;
            border-radius: var(--border-radius);
            font-family: inherit;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 150px;
            text-align: center;
        }
        
        .option-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .option-btn.selected {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .male-option.selected {
            background-color: rgba(33, 150, 243, 0.3);
            border-color: var(--male);
            color: var(--male);
        }
        
        .female-option.selected {
            background-color: rgba(233, 30, 99, 0.3);
            border-color: var(--female);
            color: var(--female);
        }
        
        .nonbinary-option.selected {
            background-color: rgba(156, 39, 176, 0.3);
            border-color: var(--nonbinary);
            color: var(--nonbinary);
        }
        
        .role-option.selected {
            background-color: rgba(233, 69, 96, 0.3);
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .beginner-option.selected {
            background-color: rgba(76, 175, 80, 0.3);
            border-color: var(--beginner);
            color: var(--beginner);
        }
        
        .intermediate-option.selected {
            background-color: rgba(255, 152, 0, 0.3);
            border-color: var(--intermediate);
            color: var(--intermediate);
        }
        
        .advanced-option.selected {
            background-color: rgba(244, 67, 54, 0.3);
            border-color: var(--advanced);
            color: var(--advanced);
        }
        
        .form-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        
        button {
            padding: 12px 30px;
            background-color: var(--accent);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-family: inherit;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }
        
        button:hover:not(:disabled) {
            background-color: #c62e4a;
            transform: translateY(-2px);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .back-btn {
            background-color: var(--secondary-bg);
        }
        
        .back-btn:hover:not(:disabled) {
            background-color: #0d1a2f;
        }
        
        .level-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background-color: var(--secondary-bg);
            border-radius: var(--border-radius);
        }
        
        .level-title {
            font-size: 1.8rem;
            color: var(--accent);
        }
        
        .level-badge {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            color: white;
        }
        
        .beginner-badge {
            background-color: var(--beginner);
        }
        
        .intermediate-badge {
            background-color: var(--intermediate);
        }
        
        .advanced-badge {
            background-color: var(--advanced);
        }
        
        .jars-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 20px;
            margin-bottom: 40px;
        }
        
        .jar-card {
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            transition: transform 0.3s ease;
            cursor: pointer;
            min-height: 180px;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .jar-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .jar-label {
            font-size: 1.3rem;
            text-align: center;
            margin-bottom: 15px;
            font-weight: 600;
            flex-grow: 1;
            display: flex;
            align-items: center;
        }
        
        .jar-controls {
            display: flex;
            gap: 10px;
            width: 100%;
        }
        
        .jar-btn {
            flex: 1;
            padding: 10px 5px;
            border-radius: var(--border-radius);
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .jar-btn.active {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
        }
        
        .tick-btn {
            background-color: rgba(76, 175, 80, 0.2);
            color: var(--tick);
        }
        
        .tick-btn.active {
            background-color: rgba(76, 175, 80, 0.5);
        }
        
        .cross-btn {
            background-color: rgba(244, 67, 54, 0.2);
            color: var(--cross);
        }
        
        .cross-btn.active {
            background-color: rgba(244, 67, 54, 0.5);
        }
        
        .question-btn {
            background-color: rgba(255, 193, 7, 0.2);
            color: var(--question);
        }
        
        .question-btn.active {
            background-color: rgba(255, 193, 7, 0.5);
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .level-nav {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .level-nav-btn {
            padding: 10px 20px;
            background-color: var(--secondary-bg);
            color: var(--text);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .level-nav-btn:hover:not(.active) {
            background-color: var(--card-bg);
        }
        
        .level-nav-btn.active {
            background-color: var(--accent);
            color: white;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            padding: 20px;
            background-color: var(--secondary-bg);
            border-radius: var(--border-radius);
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .tick-stat { color: var(--tick); }
        .cross-stat { color: var(--cross); }
        .question-stat { color: var(--question); }
        
        #screenshotContainer {
            background-color: white;
            color: #333;
            padding: 30px;
            border-radius: var(--border-radius);
            max-width: 800px;
            margin: 0 auto 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .screenshot-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .screenshot-title {
            font-size: 2.2rem;
            color: var(--accent);
            margin-bottom: 10px;
        }
        
        .user-info {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .screenshot-jars {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .screenshot-jar {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            border: 2px solid #ddd;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 120px;
        }
        
        .screenshot-jar.accepted {
            background-color: rgba(76, 175, 80, 0.1);
            border-color: var(--tick);
            color: #2E7D32;
        }
        
        .screenshot-jar.rejected {
            background-color: rgba(244, 67, 54, 0.1);
            border-color: var(--cross);
            color: #C62828;
        }
        
        .screenshot-jar.unsure {
            background-color: rgba(255, 193, 7, 0.1);
            border-color: var(--question);
            color: #FF8F00;
        }
        
        .jar-status {
            margin-top: 8px;
            font-size: 0.9rem;
            font-weight: normal;
            padding: 3px 10px;
            border-radius: 12px;
        }
        
        .accepted .jar-status {
            background-color: rgba(76, 175, 80, 0.2);
            color: #2E7D32;
        }
        
        .rejected .jar-status {
            background-color: rgba(244, 67, 54, 0.2);
            color: #C62828;
        }
        
        .unsure .jar-status {
            background-color: rgba(255, 193, 7, 0.2);
            color: #FF8F00;
        }
        
        .screenshot-legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }
        
        .legend-accepted { background-color: var(--tick); }
        .legend-rejected { background-color: var(--cross); }
        .legend-unsure { background-color: var(--question); }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: var(--secondary-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            max-width: 500px;
            width: 90%;
            text-align: center;
        }
        
        .modal h3 {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .modal input {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border-radius: var(--border-radius);
            border: 2px solid var(--card-bg);
            background-color: var(--primary-bg);
            color: var(--text);
            font-size: 1.1rem;
        }
        
        .modal-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            opacity: 0.7;
        }
        
        .completion-message {
            text-align: center;
            padding: 30px;
            background-color: var(--secondary-bg);
            border-radius: var(--border-radius);
            margin-bottom: 30px;
        }
        
        @media (max-width: 768px) {
            .jars-container {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .level-nav {
                justify-content: center;
            }
        }
        
        @media (max-width: 480px) {
            .jars-container {
                grid-template-columns: 1fr;
            }
            
            .option-btn {
                min-width: 100%;
            }
            
            .form-actions {
                flex-direction: column;
                gap: 15px;
            }
            
            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Welcome Screen -->
    <div id="welcomeScreen" class="screen active">
        <header>
            <h1>Kink Exploration Game</h1>
            <p class="subtitle">Discover and explore your interests through personalized jars</p>
        </header>
        
        <div class="profile-form">
            <div class="form-section">
                <h2 class="form-title">Gender Identity</h2>
                <p>Select your gender identity:</p>
                <div class="options-container" id="genderOptions">
                    <button class="option-btn male-option" data-value="male">Male</button>
                    <button class="option-btn female-option" data-value="female">Female</button>
                    <button class="option-btn nonbinary-option" data-value="nonbinary">Non-Binary</button>
                </div>
            </div>
            
            <div class="form-section">
                <h2 class="form-title">Role Preference</h2>
                <p>Select your primary role interest:</p>
                <div class="options-container" id="roleOptions">
                    <button class="option-btn role-option" data-value="sub">Submissive</button>
                    <button class="option-btn role-option" data-value="dom">Dominant</button>
                </div>
            </div>
            
            <div class="form-section">
                <h2 class="form-title">Experience Level</h2>
                <p>Select your experience level for your chosen role:</p>
                <div class="options-container" id="levelOptions">
                    <button class="option-btn beginner-option" data-value="beginner">Beginner</button>
                    <button class="option-btn intermediate-option" data-value="intermediate">Intermediate</button>
                    <button class="option-btn advanced-option" data-value="advanced">Advanced</button>
                </div>
            </div>
            
            <div class="form-actions">
                <button id="startGameBtn" disabled>Start Game</button>
            </div>
        </div>
        
        <footer>
            <p>This is an interactive exploration game. All kinks should be practiced safely, consensually, and with clear communication.</p>
        </footer>
    </div>
    
    <!-- Jars Screen -->
    <div id="jarsScreen" class="screen">
        <header>
            <h1>Kink Exploration Jars</h1>
            <p class="subtitle" id="userInfo">Exploring as <span id="genderDisplay"></span> <span id="roleDisplay"></span> (<span id="levelDisplay"></span>)</p>
        </header>
        
        <div class="level-header">
            <h2 class="level-title">Level: <span id="currentLevelName">Beginner</span></h2>
            <div id="currentLevelBadge" class="level-badge beginner-badge">Beginner</div>
        </div>
        
        <div id="jarsContainer" class="jars-container">
            <!-- Jars will be generated here -->
        </div>
        
        <div class="controls">
            <div class="level-nav">
                <button class="level-nav-btn active" data-level="beginner">Beginner Jars (15)</button>
                <button class="level-nav-btn" data-level="intermediate">Intermediate Jars (15)</button>
                <button class="level-nav-btn" data-level="advanced">Advanced Jars (15)</button>
            </div>
            
            <button id="generateScreenshotBtn">Generate Screenshot</button>
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <div class="stat-value tick-stat" id="tickCount">0</div>
                <div>Accepted</div>
            </div>
            <div class="stat-item">
                <div class="stat-value cross-stat" id="crossCount">0</div>
                <div>Rejected</div>
            </div>
            <div class="stat-item">
                <div class="stat-value question-stat" id="questionCount">0</div>
                <div>Unsure</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="totalCount">0</div>
                <div>Total Jars</div>
            </div>
        </div>
        
        <div class="form-actions">
            <button class="back-btn" id="backToProfileBtn">Back to Profile</button>
            <button id="resetLevelBtn">Reset Current Level</button>
        </div>
    </div>
    
    <!-- Name Input Modal -->
    <div id="nameModal" class="modal">
        <div class="modal-content">
            <h3>Enter Your Name</h3>
            <p>Please enter your name to personalize your screenshot:</p>
            <input type="text" id="userNameInput" placeholder="Enter your name" maxlength="30">
            <div class="modal-actions">
                <button id="cancelScreenshotBtn">Cancel</button>
                <button id="confirmScreenshotBtn">Generate Screenshot</button>
            </div>
        </div>
    </div>
    
    <script>
        // Game data and state
        const gameState = {
            gender: null,
            role: null,
            level: null,
            userName: null,
            currentLevel: 'beginner',
            jarsData: {
                beginner: [],
                intermediate: [],
                advanced: []
            },
            selections: {
                beginner: {},
                intermediate: {},
                advanced: {}
            }
        };

        // Kink data organized by role, gender, and level appropriateness
        const kinkDatabase = {
            // Submissive kinks
            sub: {
                // Beginner level submissive kinks
                beginner: {
                    male: [
                        "Following Instructions", "Light Bondage", "Sensory Play", "Orgasm Control", "Service Submission",
                        "Worship", "Light Spanking", "Verbal Praise", "Blindfolding", "Temperature Play (mild)",
                        "Role Play (basic)", "Consent Practice", "Sensation Exploration", "Light Teasing", "Body Worship"
                    ],
                    female: [
                        "Following Instructions", "Light Bondage", "Sensory Play", "Orgasm Control", "Service Submission",
                        "Worship", "Light Spanking", "Verbal Praise", "Blindfolding", "Temperature Play (mild)",
                        "Role Play (basic)", "Consent Practice", "Sensation Exploration", "Light Teasing", "Body Worship"
                    ],
                    nonbinary: [
                        "Following Instructions", "Light Bondage", "Sensory Play", "Orgasm Control", "Service Submission",
                        "Worship", "Light Spanking", "Verbal Praise", "Blindfolding", "Temperature Play (mild)",
                        "Role Play (basic)", "Consent Practice", "Sensation Exploration", "Light Teasing", "Body Worship"
                    ]
                },
                // Intermediate level submissive kinks
                intermediate: {
                    male: [
                        "Restraint Bondage", "Impact Play (moderate)", "Wax Play", "Sensory Deprivation", "Pet Play (light)",
                        "Forced Orgasm", "Orgasm Denial", "Discipline", "Protocol Training", "Chastity Play",
                        "Humiliation (light)", "Exhibitionism (controlled)", "Body Writing", "Suspension (basic)", "Breath Play (light)"
                    ],
                    female: [
                        "Restraint Bondage", "Impact Play (moderate)", "Wax Play", "Sensory Deprivation", "Pet Play (light)",
                        "Forced Orgasm", "Orgasm Denial", "Discipline", "Protocol Training", "Chastity Play",
                        "Humiliation (light)", "Exhibitionism (controlled)", "Body Writing", "Suspension (basic)", "Breath Play (light)"
                    ],
                    nonbinary: [
                        "Restraint Bondage", "Impact Play (moderate)", "Wax Play", "Sensory Deprivation", "Pet Play (light)",
                        "Forced Orgasm", "Orgasm Denial", "Discipline", "Protocol Training", "Chastity Play",
                        "Humiliation (light)", "Exhibitionism (controlled)", "Body Writing", "Suspension (basic)", "Breath Play (light)"
                    ]
                },
                // Advanced level submissive kinks
                advanced: {
                    male: [
                        "Full Restraint", "Heavy Impact Play", "Suspension Bondage", "Advanced Wax Play", "Knife Play (ceremonial)",
                        "Electro Play", "Fire Play", "Breath Control", "Consensual Non-Consent", "Total Power Exchange",
                        "Objectification", "Advanced Humiliation", "Branding (temporary)", "Caging/Confinement", "Sensory Overload"
                    ],
                    female: [
                        "Full Restraint", "Heavy Impact Play", "Suspension Bondage", "Advanced Wax Play", "Knife Play (ceremonial)",
                        "Electro Play", "Fire Play", "Breath Control", "Consensual Non-Consent", "Total Power Exchange",
                        "Objectification", "Advanced Humiliation", "Branding (temporary)", "Caging/Confinement", "Sensory Overload"
                    ],
                    nonbinary: [
                        "Full Restraint", "Heavy Impact Play", "Suspension Bondage", "Advanced Wax Play", "Knife Play (ceremonial)",
                        "Electro Play", "Fire Play", "Breath Control", "Consensual Non-Consent", "Total Power Exchange",
                        "Objectification", "Advanced Humiliation", "Branding (temporary)", "Caging/Confinement", "Sensory Overload"
                    ]
                }
            },
            
            // Dominant kinks
            dom: {
                // Beginner level dominant kinks
                beginner: {
                    male: [
                        "Giving Instructions", "Light Bondage", "Sensory Control", "Orgasm Control", "Receiving Service",
                        "Being Worshipped", "Light Spanking", "Verbal Praise Giving", "Blindfolding Partner", "Temperature Play (mild)",
                        "Role Play Direction", "Consent Communication", "Sensation Guidance", "Light Teasing", "Receiving Body Worship"
                    ],
                    female: [
                        "Giving Instructions", "Light Bondage", "Sensory Control", "Orgasm Control", "Receiving Service",
                        "Being Worshipped", "Light Spanking", "Verbal Praise Giving", "Blindfolding Partner", "Temperature Play (mild)",
                        "Role Play Direction", "Consent Communication", "Sensation Guidance", "Light Teasing", "Receiving Body Worship"
                    ],
                    nonbinary: [
                        "Giving Instructions", "Light Bondage", "Sensory Control", "Orgasm Control", "Receiving Service",
                        "Being Worshipped", "Light Spanking", "Verbal Praise Giving", "Blindfolding Partner", "Temperature Play (mild)",
                        "Role Play Direction", "Consent Communication", "Sensation Guidance", "Light Teasing", "Receiving Body Worship"
                    ]
                },
                // Intermediate level dominant kinks
                intermediate: {
                    male: [
                        "Restraint Application", "Impact Play (moderate)", "Wax Play Control", "Sensory Deprivation", "Pet Play Handling",
                        "Forcing Orgasm", "Orgasm Denial Control", "Discipline Administration", "Protocol Training", "Chastity Control",
                        "Humiliation (light)", "Exhibitionism Direction", "Body Writing", "Suspension (basic)", "Breath Play (light)"
                    ],
                    female: [
                        "Restraint Application", "Impact Play (moderate)", "Wax Play Control", "Sensory Deprivation", "Pet Play Handling",
                        "Forcing Orgasm", "Orgasm Denial Control", "Discipline Administration", "Protocol Training", "Chastity Control",
                        "Humiliation (light)", "Exhibitionism Direction", "Body Writing", "Suspension (basic)", "Breath Play (light)"
                    ],
                    nonbinary: [
                        "Restraint Application", "Impact Play (moderate)", "Wax Play Control", "Sensory Deprivation", "Pet Play Handling",
                        "Forcing Orgasm", "Orgasm Denial Control", "Discipline Administration", "Protocol Training", "Chastity Control",
                        "Humiliation (light)", "Exhibitionism Direction", "Body Writing", "Suspension (basic)", "Breath Play (light)"
                    ]
                },
                // Advanced level dominant kinks
                advanced: {
                    male: [
                        "Full Restraint Control", "Heavy Impact Play", "Suspension Bondage", "Advanced Wax Play", "Knife Play (ceremonial)",
                        "Electro Play Control", "Fire Play Management", "Breath Control", "Consensual Non-Consent", "Total Power Exchange",
                        "Objectification", "Advanced Humiliation", "Branding (temporary)", "Caging/Confinement", "Sensory Overload Control"
                    ],
                    female: [
                        "Full Restraint Control", "Heavy Impact Play", "Suspension Bondage", "Advanced Wax Play", "Knife Play (ceremonial)",
                        "Electro Play Control", "Fire Play Management", "Breath Control", "Consensual Non-Consent", "Total Power Exchange",
                        "Objectification", "Advanced Humiliation", "Branding (temporary)", "Caging/Confinement", "Sensory Overload Control"
                    ],
                    nonbinary: [
                        "Full Restraint Control", "Heavy Impact Play", "Suspension Bondage", "Advanced Wax Play", "Knife Play (ceremonial)",
                        "Electro Play Control", "Fire Play Management", "Breath Control", "Consensual Non-Consent", "Total Power Exchange",
                        "Objectification", "Advanced Humiliation", "Branding (temporary)", "Caging/Confinement", "Sensory Overload Control"
                    ]
                }
            }
        };

        // DOM Elements
        const welcomeScreen = document.getElementById('welcomeScreen');
        const jarsScreen = document.getElementById('jarsScreen');
        const nameModal = document.getElementById('nameModal');
        
        // Profile selection elements
        const genderOptions = document.getElementById('genderOptions');
        const roleOptions = document.getElementById('roleOptions');
        const levelOptions = document.getElementById('levelOptions');
        const startGameBtn = document.getElementById('startGameBtn');
        
        // Jars screen elements
        const jarsContainer = document.getElementById('jarsContainer');
        const levelNavButtons = document.querySelectorAll('.level-nav-btn');
        const currentLevelName = document.getElementById('currentLevelName');
        const currentLevelBadge = document.getElementById('currentLevelBadge');
        const genderDisplay = document.getElementById('genderDisplay');
        const roleDisplay = document.getElementById('roleDisplay');
        const levelDisplay = document.getElementById('levelDisplay');
        const userInfo = document.getElementById('userInfo');
        const generateScreenshotBtn = document.getElementById('generateScreenshotBtn');
        const backToProfileBtn = document.getElementById('backToProfileBtn');
        const resetLevelBtn = document.getElementById('resetLevelBtn');
        
        // Stats elements
        const tickCountElement = document.getElementById('tickCount');
        const crossCountElement = document.getElementById('crossCount');
        const questionCountElement = document.getElementById('questionCount');
        const totalCountElement = document.getElementById('totalCount');
        
        // Modal elements
        const userNameInput = document.getElementById('userNameInput');
        const cancelScreenshotBtn = document.getElementById('cancelScreenshotBtn');
        const confirmScreenshotBtn = document.getElementById('confirmScreenshotBtn');

        // Initialize the game
        function initGame() {
            // Set up option button event listeners with radio button behavior
            setupRadioButtonGroup(genderOptions, 'gender', ['male-option', 'female-option', 'nonbinary-option']);
            setupRadioButtonGroup(roleOptions, 'role', ['role-option']);
            setupRadioButtonGroup(levelOptions, 'level', ['beginner-option', 'intermediate-option', 'advanced-option']);
            
            // Start game button
            startGameBtn.addEventListener('click', startGame);
            
            // Level navigation
            levelNavButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const level = this.dataset.level;
                    switchLevel(level);
                    
                    // Update active button
                    levelNavButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Generate screenshot button
            generateScreenshotBtn.addEventListener('click', () => {
                // Check if all jars have a selection
                const currentJars = gameState.jarsData[gameState.currentLevel];
                const currentSelections = gameState.selections[gameState.currentLevel];
                
                if (Object.keys(currentSelections).length < currentJars.length) {
                    alert(`Please make a selection for all ${currentJars.length} jars in the ${gameState.currentLevel} level before generating a screenshot.`);
                    return;
                }
                
                // Show name modal
                nameModal.classList.add('active');
                userNameInput.focus();
            });
            
            // Back to profile button
            backToProfileBtn.addEventListener('click', () => {
                showScreen(welcomeScreen);
            });
            
            // Reset level button
            resetLevelBtn.addEventListener('click', resetCurrentLevel);
            
            // Modal buttons
            cancelScreenshotBtn.addEventListener('click', () => {
                nameModal.classList.remove('active');
                userNameInput.value = '';
            });
            
            confirmScreenshotBtn.addEventListener('click', generateAndDownloadScreenshot);
            
            // Allow Enter key to confirm screenshot
            userNameInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    generateAndDownloadScreenshot();
                }
            });
            
            // Update start button state
            updateStartButton();
        }

        // Set up a radio button group
        function setupRadioButtonGroup(container, stateKey, buttonClasses) {
            const buttons = container.querySelectorAll('.option-btn');
            
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    // Check if this button is already selected
                    const isAlreadySelected = this.classList.contains('selected');
                    
                    // Deselect all buttons in this group
                    buttons.forEach(btn => btn.classList.remove('selected'));
                    
                    // If it wasn't already selected, select it now
                    if (!isAlreadySelected) {
                        this.classList.add('selected');
                        gameState[stateKey] = this.dataset.value;
                    } else {
                        // If it was already selected and we clicked again, deselect it
                        gameState[stateKey] = null;
                    }
                    
                    // Update start button state
                    updateStartButton();
                });
            });
        }

        // Update start button enabled state
        function updateStartButton() {
            startGameBtn.disabled = !(gameState.gender && gameState.role && gameState.level);
        }

        // Start the game with user selections
        function startGame() {
            // Load appropriate jars based on selections
            loadJarsForProfile();
            
            // Update display info
            updateUserInfoDisplay();
            
            // Show jars screen
            showScreen(jarsScreen);
            
            // Initialize with beginner level
            switchLevel('beginner');
        }

        // Load jars based on user profile
        function loadJarsForProfile() {
            // Clear existing jars
            gameState.jarsData = {
                beginner: [],
                intermediate: [],
                advanced: []
            };
            
            gameState.selections = {
                beginner: {},
                intermediate: {},
                advanced: {}
            };
            
            // Get appropriate jars for each level
            const roleData = kinkDatabase[gameState.role];
            if (!roleData) return;
            
            // Load jars for each level
            ['beginner', 'intermediate', 'advanced'].forEach(level => {
                const levelData = roleData[level];
                if (!levelData) return;
                
                const genderData = levelData[gameState.gender] || levelData.male; // Fallback to male if gender not found
                gameState.jarsData[level] = [...genderData]; // Create a copy
            });
        }

        // Switch between levels
        function switchLevel(level) {
            gameState.currentLevel = level;
            
            // Update UI
            currentLevelName.textContent = level.charAt(0).toUpperCase() + level.slice(1);
            currentLevelBadge.textContent = level.charAt(0).toUpperCase() + level.slice(1);
            currentLevelBadge.className = `level-badge ${level}-badge`;
            
            // Display jars for this level
            displayJarsForCurrentLevel();
            
            // Update stats
            updateStats();
        }

        // Display jars for current level
        function displayJarsForCurrentLevel() {
            const jars = gameState.jarsData[gameState.currentLevel];
            const selections = gameState.selections[gameState.currentLevel];
            
            // Clear container
            jarsContainer.innerHTML = '';
            
            // Create jar cards
            jars.forEach((jar, index) => {
                const card = document.createElement('div');
                card.className = 'jar-card';
                card.dataset.index = index;
                
                // Jar label
                const labelElement = document.createElement('div');
                labelElement.className = 'jar-label';
                labelElement.textContent = jar;
                
                // Control buttons
                const controlsElement = document.createElement('div');
                controlsElement.className = 'jar-controls';
                
                // Accept button
                const acceptBtn = document.createElement('button');
                acceptBtn.className = `jar-btn tick-btn ${selections[index] === 'accept' ? 'active' : ''}`;
                acceptBtn.innerHTML = '✓';
                acceptBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    setSelection(index, 'accept');
                });
                
                // Reject button
                const rejectBtn = document.createElement('button');
                rejectBtn.className = `jar-btn cross-btn ${selections[index] === 'reject' ? 'active' : ''}`;
                rejectBtn.innerHTML = '✗';
                rejectBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    setSelection(index, 'reject');
                });
                
                // Unsure button
                const unsureBtn = document.createElement('button');
                unsureBtn.className = `jar-btn question-btn ${selections[index] === 'unsure' ? 'active' : ''}`;
                unsureBtn.innerHTML = '?';
                unsureBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    setSelection(index, 'unsure');
                });
                
                controlsElement.appendChild(acceptBtn);
                controlsElement.appendChild(rejectBtn);
                controlsElement.appendChild(unsureBtn);
                
                card.appendChild(labelElement);
                card.appendChild(controlsElement);
                jarsContainer.appendChild(card);
            });
            
            // Update total count
            totalCountElement.textContent = jars.length;
        }

        // Set selection for a jar
        function setSelection(index, value) {
            gameState.selections[gameState.currentLevel][index] = value;
            
            // Update visual state
            const card = document.querySelector(`.jar-card[data-index="${index}"]`);
            if (card) {
                const acceptBtn = card.querySelector('.tick-btn');
                const rejectBtn = card.querySelector('.cross-btn');
                const unsureBtn = card.querySelector('.question-btn');
                
                // Reset all buttons
                acceptBtn.classList.remove('active');
                rejectBtn.classList.remove('active');
                unsureBtn.classList.remove('active');
                
                // Activate selected button
                if (value === 'accept') {
                    acceptBtn.classList.add('active');
                } else if (value === 'reject') {
                    rejectBtn.classList.add('active');
                } else if (value === 'unsure') {
                    unsureBtn.classList.add('active');
                }
            }
            
            // Update stats
            updateStats();
        }

        // Update statistics display
        function updateStats() {
            const selections = gameState.selections[gameState.currentLevel];
            const jars = gameState.jarsData[gameState.currentLevel];
            
            const acceptCount = Object.values(selections).filter(s => s === 'accept').length;
            const rejectCount = Object.values(selections).filter(s => s === 'reject').length;
            const unsureCount = Object.values(selections).filter(s => s === 'unsure').length;
            
            tickCountElement.textContent = acceptCount;
            crossCountElement.textContent = rejectCount;
            questionCountElement.textContent = unsureCount;
            
            // Update level nav button text to show completion
            const levelNavBtn = document.querySelector(`.level-nav-btn[data-level="${gameState.currentLevel}"]`);
            if (levelNavBtn) {
                const totalJars = jars.length;
                const completedJars = acceptCount + rejectCount + unsureCount;
                levelNavBtn.textContent = `${gameState.currentLevel.charAt(0).toUpperCase() + gameState.currentLevel.slice(1)} Jars (${completedJars}/${totalJars})`;
            }
        }

        // Update user info display
        function updateUserInfoDisplay() {
            const genderMap = {
                male: 'Male',
                female: 'Female',
                nonbinary: 'Non-Binary'
            };
            
            const roleMap = {
                sub: 'Submissive',
                dom: 'Dominant'
            };
            
            const levelMap = {
                beginner: 'Beginner',
                intermediate: 'Intermediate',
                advanced: 'Advanced'
            };
            
            genderDisplay.textContent = genderMap[gameState.gender];
            roleDisplay.textContent = roleMap[gameState.role];
            levelDisplay.textContent = levelMap[gameState.level];
            
            userInfo.textContent = `Exploring as ${genderMap[gameState.gender]} ${roleMap[gameState.role]} (${levelMap[gameState.level]})`;
        }

        // Reset current level selections
        function resetCurrentLevel() {
            if (confirm(`Are you sure you want to reset all selections for the ${gameState.currentLevel} level?`)) {
                gameState.selections[gameState.currentLevel] = {};
                displayJarsForCurrentLevel();
                updateStats();
            }
        }

        // Generate and download screenshot
        function generateAndDownloadScreenshot() {
            const userName = userNameInput.value.trim();
            
            if (!userName) {
                alert('Please enter your name');
                userNameInput.focus();
                return;
            }
            
            gameState.userName = userName;
            
            // Close modal
            nameModal.classList.remove('active');
            userNameInput.value = '';
            
            // Create a temporary screenshot container
            const tempContainer = document.createElement('div');
            tempContainer.style.position = 'absolute';
            tempContainer.style.left = '-9999px';
            tempContainer.style.top = '-9999px';
            tempContainer.style.width = '800px';
            tempContainer.style.backgroundColor = 'white';
            tempContainer.style.padding = '30px';
            tempContainer.style.borderRadius = '10px';
            tempContainer.style.color = '#333';
            
            // Create screenshot content
            const screenshotHTML = createScreenshotContent();
            tempContainer.innerHTML = screenshotHTML;
            
            // Add to document
            document.body.appendChild(tempContainer);
            
            // Use html2canvas to capture the screenshot
            html2canvas(tempContainer, {
                backgroundColor: '#FFFFFF',
                scale: 2,
                useCORS: true,
                logging: false
            }).then(canvas => {
                // Create download link
                const link = document.createElement('a');
                link.download = `kink-exploration-${gameState.userName.replace(/\s+/g, '-').toLowerCase()}-${gameState.currentLevel}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                // Clean up
                document.body.removeChild(tempContainer);
                
                // Show success message
                alert('Screenshot downloaded successfully!');
            }).catch(error => {
                console.error('Error generating screenshot:', error);
                alert('There was an error generating the screenshot. Please try again.');
                
                // Clean up
                document.body.removeChild(tempContainer);
            });
        }

        // Create screenshot content
        function createScreenshotContent() {
            const genderMap = {
                male: 'Male',
                female: 'Female',
                nonbinary: 'Non-Binary'
            };
            
            const roleMap = {
                sub: 'Submissive',
                dom: 'Dominant'
            };
            
            const levelMap = {
                beginner: 'Beginner',
                intermediate: 'Intermediate',
                advanced: 'Advanced'
            };
            
            // Get current level data
            const jars = gameState.jarsData[gameState.currentLevel];
            const selections = gameState.selections[gameState.currentLevel];
            
            // Build screenshot HTML
            let screenshotHTML = `
                <div style="text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #eee;">
                    <h1 style="font-size: 2.2rem; color: #e94560; margin-bottom: 10px;">Kink Exploration Profile</h1>
                    <div style="font-size: 1.2rem; margin-bottom: 5px;">Name: ${gameState.userName}</div>
                    <div style="font-size: 1.2rem; margin-bottom: 5px;">Gender: ${genderMap[gameState.gender]}</div>
                    <div style="font-size: 1.2rem; margin-bottom: 5px;">Role: ${roleMap[gameState.role]}</div>
                    <div style="font-size: 1.2rem; margin-bottom: 5px;">Level: ${levelMap[gameState.currentLevel]}</div>
                    <div style="font-size: 1.2rem; margin-bottom: 5px;">Date: ${new Date().toLocaleDateString()}</div>
                </div>
            `;
            
            // Add jars for current level
            screenshotHTML += `
                <h3 style="color: #e94560; margin: 30px 0 15px 0; border-bottom: 2px solid #e94560; padding-bottom: 5px;">
                    ${gameState.currentLevel.charAt(0).toUpperCase() + gameState.currentLevel.slice(1)} Level Jars
                </h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
            `;
            
            jars.forEach((jar, index) => {
                const selection = selections[index] || 'unsure';
                const statusMap = {
                    accept: 'Accepted',
                    reject: 'Rejected',
                    unsure: 'Unsure'
                };
                
                const bgColor = selection === 'accept' ? 'rgba(76, 175, 80, 0.1)' : 
                               selection === 'reject' ? 'rgba(244, 67, 54, 0.1)' : 
                               'rgba(255, 193, 7, 0.1)';
                
                const borderColor = selection === 'accept' ? '#4CAF50' : 
                                   selection === 'reject' ? '#f44336' : 
                                   '#FFC107';
                
                const textColor = selection === 'accept' ? '#2E7D32' : 
                                 selection === 'reject' ? '#C62828' : 
                                 '#FF8F00';
                
                screenshotHTML += `
                    <div style="padding: 15px; border-radius: 8px; text-align: center; font-weight: bold; border: 2px solid ${borderColor}; background-color: ${bgColor}; color: ${textColor}; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 120px;">
                        <div>${jar}</div>
                        <div style="margin-top: 8px; font-size: 0.9rem; font-weight: normal; padding: 3px 10px; border-radius: 12px; background-color: ${bgColor.replace('0.1', '0.2')}; color: ${textColor};">${statusMap[selection]}</div>
                    </div>
                `;
            });
            
            screenshotHTML += `</div>`;
            
            // Add legend
            screenshotHTML += `
                <div style="display: flex; justify-content: center; flex-wrap: wrap; gap: 15px; margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 20px; height: 20px; border-radius: 50%; background-color: #4CAF50;"></div>
                        <span>Accepted (Very Interested)</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 20px; height: 20px; border-radius: 50%; background-color: #f44336;"></div>
                        <span>Rejected (Definitely Not)</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 20px; height: 20px; border-radius: 50%; background-color: #FFC107;"></div>
                        <span>Unsure (Want to Learn More)</span>
                    </div>
                </div>
            `;
            
            return screenshotHTML;
        }

        // Show specific screen
        function showScreen(screen) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            screen.classList.add('active');
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        // Initialize the game when page loads
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
